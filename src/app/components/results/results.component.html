<section class="results">
  <header title="{{ running ? 'Loading' : 'Finished' }} {{ fileName }} - {{ previewData?.total }} Rows"
          [icon]="icon" [theme]="theme"></header>
  <novo-nav [outlet]="tabs" direction="horizontal" [class]="theme">
    <novo-tab>Overview</novo-tab>
    <novo-tab>Command Line</novo-tab>
  </novo-nav>
  <novo-nav-outlet #tabs>
    <novo-nav-content class="tab-overview">
      <div class="overview">
        <div class="chart">
            <novo-card-chart-donut [value]="loadedPercent" [label]="loadedLabel" color="#662255"></novo-card-chart-donut>
        </div>
        <div class="totals">
          <novo-list direction="vertical">
            <novo-list-item>
              <item-header>
                <item-avatar icon="bhi-clock-arrow"></item-avatar>
                <item-title>Started at:</item-title>
                <item-header-end>{{ results?.startTime | date:'mediumTime' }}</item-header-end>
              </item-header>
            </novo-list-item>
            <novo-list-item>
              <item-header>
                <item-avatar icon="bhi-clock"></item-avatar>
                <item-title>Duration:</item-title>
                <item-header-end>{{ this.duration }}</item-header-end>
              </item-header>
            </novo-list-item>
            <novo-list-item>
              <item-header>
                <item-avatar icon="bhi-add-thin"></item-avatar>
                <item-title>{{ results?.inserted }} Added</item-title>
                <item-header-end *ngIf="loaded > 0">
                  <button theme="dialogue" icon="save" [disabled]="running"
                          tooltip="Download Added Rows" (click)="openFile(results?.successFile)">CSV
                  </button>
                </item-header-end>
              </item-header>
            </novo-list-item>
            <novo-list-item>
              <item-header>
                <item-avatar icon="bhi-refresh-o"></item-avatar>
                <item-title>{{ results?.updated }} Updated</item-title>
              </item-header>
            </novo-list-item>
            <novo-list-item>
              <item-header>
                <item-avatar icon="bhi-caution"></item-avatar>
                <item-title>{{ results?.failed }} Errors</item-title>
                <item-header-end *ngIf="results?.failed > 0">
                  <button theme="dialogue" icon="save" [disabled]="running"
                          tooltip="Download Failed Rows" (click)="openFile(results?.failureFile)">CSV
                  </button>
                </item-header-end>
              </item-header>
            </novo-list-item>
          </novo-list>
        </div>
      </div>
      <div class="errors" *ngIf="results?.errors">
        <novo-table theme="grapefruit" [rows]="errorTable.rows" [columns]="errorTable.columns"
                    [config]="errorTable.config">
          <novo-table-header class="table-header">
            <i class="header-icon bhi-caution"></i>
            <div class="header-titles">
              <h1>{{ results?.errors.length }} Errors</h1>
            </div>
          </novo-table-header>
        </novo-table>
      </div>
    </novo-nav-content>
    <novo-nav-content>
      <div class="output">{{ output }}</div>
    </novo-nav-content>
  </novo-nav-outlet>
  <footer>
    <button theme="primary" icon="save" [disabled]="running"
            [tooltip]="results?.logFile" (click)="openFile(results?.logFile)">Log File
    </button>
    <button theme="primary" (click)="stop()" [disabled]="!running" color="negative" icon="times">
      Stop
    </button>
  </footer>
</section>
